<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Untangling Microservices, or Balancing Complexity in Distributed Systems</title>
  <meta property="og:title" content="Untangling Microservices, or Balancing Complexity in Distributed Systems" />
  <meta name="twitter:title" content="Untangling Microservices, or Balancing Complexity in Distributed …" />
  <meta name="description" content="

The microservices honeymoon period is over. Uber is refactoring thousands of microservices into a more manageable solution [1]; Kelsey Hightower is predicting monoliths are the future [2]; and even Sam Newman is declaring that microservices should never be the default choice, but rather a last resort [3].

What&rsquo;s going on here? Why have so many projects become unmaintainable, despite microservices’ promise of simplicity and flexibility? Or are monoliths better, after all?

In this post, I want to address these questions. You will learn about common design issues that turn microservices into distributed big balls of mud – and, of course, how you can avoid them.">
  <meta property="og:description" content="

The microservices honeymoon period is over. Uber is refactoring thousands of microservices into a more manageable solution [1]; Kelsey Hightower is predicting monoliths are the future [2]; and even Sam Newman is declaring that microservices should never be the default choice, but rather a last resort [3].

What&rsquo;s going on here? Why have so many projects become unmaintainable, despite microservices’ promise of simplicity and flexibility? Or are monoliths better, after all?

In this post, I want to address these questions. You will learn about common design issues that turn microservices into distributed big balls of mud – and, of course, how you can avoid them.">
  <meta name="twitter:description" content="

The microservices honeymoon period is over. Uber is refactoring thousands of microservices into a more manageable solution [1]; Kelsey Hightower is predicting monoliths are the future [2]; and even …">
  <meta name="author" content="Vladik Khononov"/>
  <link href='https://vladikk.com/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://vladikk.com/images/untangling-microservices/header.png" />
  <meta name="twitter:image" content="https://vladikk.com/images/untangling-microservices/header.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@vladikk" />
  <meta name="twitter:creator" content="@vladikk" />
  <meta property="og:url" content="https://vladikk.com/2020/04/09/untangling-microservices/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Vladikk" />

  <meta name="generator" content="Hugo 0.56.3" />
  <link rel="canonical" href="https://vladikk.com/2020/04/09/untangling-microservices/" />
  <link rel="alternate" href="" type="application/rss+xml" title="Vladikk">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://vladikk.com/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://vladikk.com/css/highlighting.css" />
  <link rel="stylesheet" href="https://vladikk.com/css/pygment_highlights.css" />
  <link rel="stylesheet" href="https://vladikk.com/css/highlight.min.css" /> <meta name="keywords" content="microservices, nanoservices, bbom, monolith, distributed systems, antipattern, anti-pattern, software architecture, design patterns, design principles, ddd, engineering, design, software, architecture">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-40869819-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://vladikk.com">Vladikk</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="Conferences" href="/page/speaking/">Conferences</a>
            </li>
          
        
          
            <li>
              <a title="Books" href="/page/books/">Books</a>
            </li>
          
        
          
            <li>
              <a title="Consulting" href="/page/consulting">Consulting</a>
            </li>
          
        
          
            <li>
              <a title="About &amp; Contact" href="/page/about/">About &amp; Contact</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Vladikk" href="https://vladikk.com">
            <img class="avatar-img" src="https://vladikk.com/images/me-oreilly.jpg" alt="Vladikk" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>Untangling Microservices, or Balancing Complexity in Distributed Systems</h1>
                
                
                  <span class="post-meta">
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on April 9, 2020
  &nbsp;|&nbsp; <i class="fa fa-clock-o"></i> 16 min (3250 mots)
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p><img src="/images/untangling-microservices/header.png" alt="Untangling Microservices, or Balancing Complexity in Distributed Systems" /></p>

<p>The microservices honeymoon period is over. Uber is refactoring thousands of microservices into a more manageable solution [1]; Kelsey Hightower is predicting monoliths are the future [2]; and even Sam Newman is declaring that microservices should never be the default choice, but rather a last resort [3].</p>

<p>What&rsquo;s going on here? Why have so many projects become unmaintainable, despite microservices’ promise of simplicity and flexibility? Or are monoliths better, after all?</p>

<p>In this post, I want to address these questions. You will learn about common design issues that turn microservices into distributed big balls of mud – and, of course, how you can avoid them.</p>

<p>But first, let’s set the record straight on what a monolith is.</p>

<h2 id="monolith">Monolith</h2>

<p>Microservices have always been positioned as a solution for monolithic codebases. But are monoliths necessarily a problem? According to Wikipedia’s definition [4], a monolithic application is self-contained and independent from other computing applications. Independence from other applications? Isn’t that what we are chasing, often to no avail, when we design microservices? David Heinemeier Hansson [5] called out the smearing of monoliths right away. He warned about the liabilities and challenges inherent to distributed systems, and used Basecamp to prove that a large system serving millions of customers can be implemented and maintained in a monolithic codebase.</p>

<p>Hence, microservices do not “fix” monoliths. The real problem that microservices are supposed to solve is an inability to deliver business goals. Often, teams fail to achieve business goals because of the exponentially growing — or even worse unpredictable — costs of making a change. In other words, the system is unable to keep up with the needs of the business. The uncontrollable cost of change is not a property of a monolith but rather of a big ball of mud [6]:</p>

<blockquote>
<p>A Big Ball of Mud is a haphazardly structured, sprawling, sloppy, duct-tape-and-baling-wire, spaghetti-code jungle. These systems show unmistakable signs of unregulated growth, and repeated, expedient repair. Information is shared promiscuously among distant elements of the system, often to the point where nearly all the important information becomes global or duplicated.</p>
</blockquote>

<p>The complexity of changing and evolving a big ball of mud can be caused by multiple factors: coordinating the work of multiple teams, conflicting non-functional requirements, or an intricate business domain. Either way, we often seek to tackle this complexity by decomposing such clumsy solutions into microservices.</p>

<h2 id="micro-what">Micro<em>what?</em></h2>

<p>The term “microservice” implies that some part of a service can be measured and its value should be minimized. But what does microservice mean, exactly? Let’s examine a few common ways the term is used.</p>

<h3 id="micro-teams">Micro<em>teams</em></h3>

<p>The first one is the size of the team that works on a service. And this metric should be measured in pizzas. Seriously. They say that if a team working on a service can be fed with two pizzas, then it’s a microservice. I find this heuristic anecdotal, as I’ve built projects with teams that could be fed with one pizza …and I dare anyone to call those balls of mud microservices!</p>

<h3 id="micro-codebases">Micro<em>codebases</em></h3>

<p>Another widespread approach is to design a microservice based on the size of its codebase. Some take this notion to the extreme and try to limit service sizes to a certain number of lines of code. That said, the exact number of lines needed to constitute a microservice is yet to be found. Once this holy grail of software architecture is discovered, we will move on to the next question — what is the recommended editor width for building microservices?</p>

<p>On a more serious note, a less extreme version of this approach is the prevalent one. The size of a codebase is often used as a heuristic for deciding whether it is a microservice or not.</p>

<p>In some way, this approach makes sense. The smaller the codebase, the lower the scope of the business domain. Thus, it’s simpler to understand, to implement, and to evolve. Moreover, a smaller codebase has fewer chances of turning into a big ball of mud – and if it does happen, it is simpler to refactor.</p>

<p>Unfortunately, the aforementioned simplicity is just an <strong>illusion</strong>. When we evaluate a service’s design based on the service itself, we miss a crucial part of system design. We forget the <strong>system</strong> itself, the system that the service is a <strong>component</strong> of.</p>

<blockquote>
<p>&ldquo;There are many useful and revealing heuristics for defining the boundaries of a service. Size is one of the least useful.&rdquo; ~ Nick Tune</p>
</blockquote>

<h3 id="we-build-systems">We Build Systems!</h3>

<p>We build systems, not sets of services. We use microservices-based architecture to optimize a system’s design, not the design of individual services. No matter what others may say, microservices cannot, and will never be neither completely decoupled, nor fully independent. <strong>You cannot build a system out of independent components!</strong> That would go against the very definition of the term “system” [7]:</p>

<blockquote>
<ol>
<li>A set of <strong>connected</strong> things or devices that <strong>operate together</strong></li>
<li>A set of computer equipment and programs <strong>used together for a particular purpose</strong></li>
</ol>
</blockquote>

<p>Services will always have to interact with each other to form a system. If you design a system by optimizing its services, but ignore the interactions between them, this is what you may end up with this:</p>

<p><img src="/images/untangling-microservices/complex-system.png" alt="" /></p>

<p>Those “microservices” may be simple individually, but the system itself is a complexity hell!</p>

<p>So how do we design microservices that tackle the complexity not only of the services, but of the system as a whole?</p>

<p>That’s a tough question, but luckily for us, it was answered a long time ago.</p>

<h2 id="a-system-wide-perspective-on-complexity">A System-Wide Perspective on Complexity</h2>

<p>Forty years ago, there was no cloud computing, no global-scale requirements, and no need to deploy a system every 11.7 seconds. But engineers still had to tame systems’ complexity. Even though the tools in those days were different, the challenges – and more importantly, the solution — are all relevant nowadays, and can be applied to the design of microservices-based systems.</p>

<p>In his book, “Composite/Structured Design” [8], Glenford J. Myers discusses how to structure procedural code to reduce its complexity. On the very first page of the book, he writes:</p>

<blockquote>
<p><strong>There is much more to the subject of complexity than simply attempting to minimize the local complexity of each part of a program. A much more important type of complexity is global complexity: the complexity of the overall structure of a program or system (i.e., the degree of association or interdependence among the major pieces of a program).</strong></p>
</blockquote>

<p>In our context, <strong>local complexity is the complexity of each individual microservice</strong>, whereas <strong>global complexity is the complexity of the whole system</strong>. Local complexity depends on the <strong>implementation</strong> of a service; global complexity is defined by the <strong>interactions and dependencies</strong> between the services.</p>

<p>So which complexity is more important — local or global? Let’s see what happens when only one of the complexities is taken care of.</p>

<p>It’s surprisingly easy to reduce global complexity to a minimum. All we have to do is to eliminate any interactions between the system’s components — i.e., implement all functionality in one monolithic service. As we’ve seen earlier, this strategy may work in certain scenarios. In others, it may lead to the dreaded <strong>big ball of mud – probably the highest possible level of local complexity</strong>.</p>

<p>On the other hand, we know what happens when you optimize only the local complexity, but neglect the system&rsquo;s global complexity — the <em>even more dreaded</em> <strong>distributed big ball of mud</strong>.</p>

<p><img src="/images/untangling-microservices/bboms.png" alt="" /></p>

<p>Hence, if we concentrate on only one type of complexity, it doesn&rsquo;t matter which one is chosen. In a fairly complex distributed system, the opposite complexity will skyrocket. Therefore, we can&rsquo;t optimize only one. Insted, we have to balance both the local and global complexities.</p>

<p>Interestingly, the means for balancing complexity described in the “Composite/Structured Design” book are not only relevant to distributed systems They also offer insight into how to design microservices.</p>

<h2 id="microservices">Microservices</h2>

<p>Let’s start by defining what exactly are those services and microservices, that we are talking about.</p>

<h3 id="what-is-a-service">What is a Service?</h3>

<p>According to OASIS Standard [9], a service is:</p>

<blockquote>
<p>A mechanism to enable <strong>access to one or more capabilities</strong>, where the access is provided using a <strong>prescribed interface</strong>.</p>
</blockquote>

<p>The prescribed interface part is crucial. A service’s interface defines the functionality it exposes to the world. According to Randy Shoup [10], a service’s public interface is simply any mechanism that gets data in or out of a service. It can be synchronous, such as a plain request/response model, or asynchronous. one that produces and consumes events. Either way, synchronous or asynchronous, the public interface is just the means for getting data in or out of a service. Randy also describes the service’s public interfaces as its <strong>front door</strong>.</p>

<p>A service is defined by its public interface, and this definition is enough to define what makes a service a <em>microservice</em>.</p>

<h3 id="what-is-a-microservice">What is a Microservice?</h3>

<p>If a service is defined by its public interface, then —</p>

<p><strong>A microservice is a service with a micro public interface — micro front door.</strong></p>

<p>This simple heuristic was followed in the days of procedural programming, and it is more than relevant in the realm of distributed systems. The smaller the service you expose, the simpler its implementation, and the lower its local complexity. From the global complexity standpoint, smaller public interfaces produce fewer dependencies and connections between services.</p>

<p>The notion of micro-interfaces also explains the widespread practice of microservices not exposing their databases. No microservice can access another microservice&rsquo;s database, but only through its public interface. Why is that? — <em>Well, a database would be a huge public interface!</em> Just consider how many different operations you can execute on a relational database.</p>

<p>Hence, to reiterate, in distributed systems, we balance local and global complexities by minimizing the services’ public interfaces, and thus making them micro<strong>services</strong>.</p>

<h4 id="warning">WARNING</h4>

<p>This heuristic may sound deceptively simple. If a microservice is just a service with a micro public interface, then we can just limit public interfaces to only one method. Since the front door can’t be any smaller than that, those should be the perfect microservices, right? <em>Not really.</em> To demonstrate why not, I’ll use the example from my another post [11] on this subject:</p>

<p>Let’s say we have the following backlog management service:</p>

<p><img src="/images/untangling-microservices/backlog-service.png" alt="" /></p>

<p>Once we decompose it into 8 services, each having a single public method, we get services with perfect local complexities:</p>

<p><img src="/images/untangling-microservices/naive.png" alt="" /></p>

<p>But can we connect them into the system that actually manages the backlog? <em>Not really.</em> To form the system, the services have to interact with each other and share changes to each service’s state. <em>But they can’t.</em> The services’ public interfaces do not support that.</p>

<p>Hence, we have to extend the <em>front doors</em> with public methods that <em>enable integration</em> between the services:</p>

<p><img src="/images/untangling-microservices/interactions.png" alt="" /></p>

<p>Boom. If we optimize the complexity of each service individually, the naïve decomposition works great. However, when we try to connect the services into a system, global complexity kicks in. Not only does the resulting system become an entangled mess; we also have to extend the public interfaces beyond our original intent — for the integration’s sake. Paraphrasing Randy Shoup, in addition to the tiny front door, we created a <em>huge</em> &ldquo;staff only&rdquo; entrance! Which brings us to an important point:</p>

<p><strong>A service having more integration-related than business-related methods is a strong heuristic for a growing distributed big ball of mud!</strong></p>

<p>Hence, the threshold upon which a service’s public interface can be minimized depends not only on the service itself, but (mainly) on the system that the service is a part of. A proper decomposition to microservices should <em>balance</em> the system’s global complexity and the local complexities of its services.</p>

<h3 id="designing-service-boundaries">Designing Service Boundaries</h3>

<blockquote>
<p>“Finding service boundaries is really damn hard… There is no flowchart!” - Udi Dahan</p>
</blockquote>

<p>The above statement by Udi Dahan is especially true for microservices-based systems. Designing microservices’ boundaries is hard, and probably impossible to get right the first time. That makes designing a fairly complex microservices-based system an iterative process.</p>

<p>Hence, it is safer to start with wider boundaries - probably the boundaries of proper bounded contexts[12] - and decompose them into microservices later, as more knowledge is gained about the system and its business domain. This is especially relevant to services encompassing core business domains[13].</p>

<h3 id="microservices-outside-of-distributed-systems">Microservices Outside of Distributed Systems</h3>

<p>Even though microservices were &ldquo;invented&rdquo; only recently, you can find plenty of implementations of the same design principles in other industries. These simple-mentations include:</p>

<h4 id="cross-functional-teams">Cross-Functional Teams</h4>

<p>We all know that cross-funcitonal teams are the most effective ones. Such team is a diverse group of professionals all working on the same task. An efficient cross-functional team maximizes the communication inside of the team, and minimizes the communication outside of it.</p>

<p>Our industry discovered cross-functional teams only recently, but task forces have been around forever. The underlying principles for these are the same as those for a microservices-based system: high cohesion inside the team, and low coupling between teams. The team&rsquo;s &ldquo;public interface&rdquo; is minimized by incorpo-rating the skills needed to achieve the task into the team (i.e., implementation details).</p>

<h4 id="microprocessors">Microprocessors</h4>

<p>I stumbled upon this example in Vaughn Vernon&rsquo;s wonderful <a href="https://kalele.io/microservices-and-microservices/">blog on the same topic</a>. In his post, Vaughn draws an interesting parallel between micro<em>services</em> and micro<em>processors</em>. In particular, he discusses the difference between processors and microprocessors:</p>

<blockquote>
<p>I find it interesting that there is a size classification given that helps determine whether or not a central processing unit (CPU) is considered a Microprocessor: the size of its <strong>data bus</strong> [21]</p>
</blockquote>

<p>A microprocessor&rsquo;s data bus is its public interface – it defines the amount of data that can be passed between the microprocessor and other components. There is a strict size classification for the public interface that defines whether or not a central processing unit (CPU) is considered a microprocessor.</p>

<h4 id="unix-philosophy">Unix Philosophy</h4>

<p>Unix philosophy, or the Unix way, is a set of cultural norms and philosophical approaches to minimalist, modular software development [22].</p>

<p>One may argue that the Unix philosophy contradicts my case that you cannot build a system out of fully independent components: <em>Aren&rsquo;t unix programs fully independent, and yet do form a working system?</em> The opposite is true. The Unix way almost literally defines that programs have to expose micro-interaces. Let&rsquo;s see how the principles of the Unix philosophy relate to the notion of microservices:</p>

<p>The first principle calls for programs&rsquo; public interfaces to expose one coherent function, instead of cluttering programs with functionality not related to their original goal:</p>

<blockquote>
<p>Make each program do one thing well. To do a new job, <strong>build afresh rather than complicate old programs by adding new &ldquo;features&rdquo;</strong>.</p>
</blockquote>

<p>Even though Unix commands are considered fully independent from each other, they are not. They still have to communicate with other, and the second principle defines how the communication interfaces should be designed:</p>

<blockquote>
<p>Expect the output of every program to become the input to another, as yet unknown, program. <strong>Don&rsquo;t clutter output with extraneous information</strong>. Avoid stringently columnar or binary input formats. Don&rsquo;t insist on interactive input.</p>
</blockquote>

<p>Not only the communication interface is strictly limited (standard input, standard output, and standard error), but according to this principle, the data passed between the commands should be strictly limited as well. I.e., Unix commands have to expose micro-interfaces and never depend on each other&rsquo;s implementation details.</p>

<h3 id="what-about-nano-services">What About <em>Nano</em>-services?</h3>

<p>The term “nanoservice” is often used to describe a service that is too small. One can say that those naïve one-method-services in the previous example are nanoservices. However, I don&rsquo;t necessarily agree with this classification.</p>

<p>Nanoservices are used to describe individual services while ignoring the overarching system. In the above example, once we put the system into the equation, the services’ interfaces had to grow. In fact, if we compare the original single service implementation with the naïve decomposition, we can see that once we connect the services into a system, the system goes from 8 public methods overall to 38. Moreover, the average number of public methods per service jumps from the desired 1 all the way to 4.75.</p>

<p>Hence, if instead of codebases, we optimize services (public interfaces), the term <em>nano</em>-service doesn’t hold up anymore, as the <em>service</em> is forced to grow back up to support its system’s use-cases.</p>

<h3 id="is-that-all-there-is-to-it">Is That All There Is To It?</h3>

<p>No. Although minimizing the public interfaces of services is a good guiding principle for designing microservices, it’s still just a heuristic and doesn’t replace common sense. In fact, the micro-interface is just a kind of abstraction over the more fundamental, but much more complex design principles of coupling and cohesion.</p>

<p>For example, if two services have micro-public interfaces, but they have to be coordinated in a distributed transaction, they are still highly coupled to each other.</p>

<p>That said, aiming for micro-interfaces is still a strong heuristic that addresses different types of coupling, such as functional, development, and semantic. But that’s a topic for another blog.</p>

<h2 id="from-theory-to-practice">From Theory to Practice</h2>

<p>Unfortunately, we don&rsquo;t have an objective way to quantify local and global complexities yet. On the other hand, we do have some design heuristics that can improve the design of distributed systems.</p>

<p>The main message of this post is that you should continuously evaluate the public interfaces of your services by asking:</p>

<ul>
<li>What is the ratio of business- and integration-oriented endpoints in a given service?</li>
<li>Are there, business-wise, unrelated endpoints in a service? Can you split them across two or more services without introducing integration-oriented endpoints?</li>
<li>Would merging two services eliminate endpoints that were added to integrate the original services?</li>
</ul>

<p>Use these heuristics to guide the design of your services&rsquo; boundaries and interfaces.</p>

<h2 id="summary">Summary</h2>

<p>I want to sum it all up with an observation from Eliyahu Goldratt. In his books, he often repeated these words:</p>

<blockquote>
<p>“Tell me how you measure me, and I will tell you how I will behave” ~ Eliyahu Goldratt</p>
</blockquote>

<p>When designing microservices-based systems, it’s crucial to measure and optimize the right metric. Designing boundaries for micro<em>codebases</em>, and micro<em>teams</em> is definitely easier. However, to build a <em>system</em>, we have to take it into account. Microservices are about designing systems, not individual services.</p>

<p>And that brings us back to the title of the post — “Untangling Microservices, or Balancing Complexity in Distributed Systems”. <strong>The only way to untangle microservices is to balance the local complexity of each service and the global complexity of the whole system.</strong></p>

<h2 id="p-s">P.S.</h2>

<p>I&rsquo;m overwhelmed and humbled by the positive responses to this post. Hence, I&rsquo;ll turn it into &ldquo;Untangling Microservices&rdquo; blog series. In the next posts I&rsquo;ll share some practical tips for minimizing synchronous and asynchronous interfaces of your services, and general heuristics for evaluating and designing service boundaries.</p>

<p>Feel free to nag me (@vladikk) if you are reading this after May 2020 and there is no link to the next post.</p>

<h2 id="bibliography">Bibliography</h2>

<ol>
<li><a href="https://twitter.com/GergelyOrosz/status/1247132806041546754">Gergely Orosz&rsquo;s tweet on Uber</a></li>
<li><a href="https://changelog.com/posts/monoliths-are-the-future">Monoliths are the future</a></li>
<li><a href="https://www.theregister.co.uk/2020/03/04/microservices_last_resort/">Microservices guru warns devs that trendy architecture shouldn&rsquo;t be the default for every app, but &lsquo;a last resort&rsquo;</a></li>
<li><a href="https://en.wikipedia.org/wiki/Monolithic_application">Monolithic Application(Wikipedia)</a></li>
<li><a href="https://m.signalvnoise.com/the-majestic-monolith/">The Majestic Monolith - DHH</a></li>
<li><a href="https://en.wikipedia.org/wiki/Big_ball_of_mud">Big Ball of Mud(Wikipedia)</a></li>
<li><a href="https://dictionary.cambridge.org/dictionary/english/system">Definition of a System</a></li>
<li><a href="https://www.amazon.com/Composite-Structured-Design-Glenford-Myers/dp/0442805845">Composite/Structures Design - book by Glenford J. Myers</a></li>
<li><a href="https://docs.oasis-open.org/soa-rm/v1.0/soa-rm.html">Reference Model for Service Oriented Architecture</a></li>
<li><a href="https://www.youtube.com/watch?v=E8-e-3fRHBw">Managing Data in Microservices - talk by Randy Shoup</a></li>
<li><a href="https://vladikk.com/2018/02/28/microservices/">Tackling Complexity in Microservices</a></li>
<li><a href="https://vladikk.com/2018/01/21/bounded-contexts-vs-microservices/">Bounded Contexts are NOT Microservices</a></li>
<li><a href="https://vladikk.com/2018/01/26/revisiting-the-basics-of-ddd/">Revisiting the Basics of Domain-Driven Design</a></li>
<li><a href="https://www.amazon.com/Implementing-Domain-Driven-Design-Vaughn-Vernon/dp/0321834577">Implementing Domain-Driven Design - book by Vaughn Vernon</a></li>
<li><a href="http://www.kamilgrzybek.com/design/modular-monolith-primer/">Modular Monolith: A Primer - Kamil Grzybek</a></li>
<li><a href="https://pdfs.semanticscholar.org/d420/c8b473a23b80241fd7c90757becb59b1136c.pdf">A Design Methodology for Reliable Software Systems - Barbara Liskov</a></li>
<li><a href="https://learning.oreilly.com/library/view/designing-autonomous-teams/9781491994320/">Designing Autonomous Teams and Services</a></li>
<li><a href="https://www.youtube.com/watch?v=ECM1rPYxvD4">Emergent Boundaries - a talk by Mathias Verraes</a></li>
<li><a href="https://www.youtube.com/watch?v=MjIfWe6bn40">Long Sad Story of Microservices - talk by Greg Young</a></li>
<li><a href="https://www.w3.org/DesignIssues/Principles.html">Principles of Design - Tim Berners-Lee</a></li>
<li><a href="https://kalele.io/microservices-and-microservices/">Microservices and [Micro]services - Vaughn Vernon</a></li>
<li><a href="https://en.wikipedia.org/wiki/Unix_philosophy">Unix Philosophy</a></li>
</ol>
      </article>

      <hr/>
      <div id="share">
      If you liked this post, please share it with your friends and colleagues:
      <p><div class="addthis_inline_share_toolbox"></div></p>
    </div>

      <ul class="pager blog-pager">
        
          <li class="previous">
            <a href="https://vladikk.com/2019/04/18/optimistic-consistency/" data-toggle="tooltip" data-placement="top" title="Anti-Pattern: Optimistic Consistency">&larr; Previous Post</a>
          </li>
        
        
          <li class="next">
            <a href="https://vladikk.com/2024/09/28/aws-eda/" data-toggle="tooltip" data-placement="top" title="Event-Driven Architecture on AWS: The Basics">Next Post &rarr;</a>
          </li>
        
      </ul>


      
        
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "vladikk-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:vladik@khononov.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/vladikk" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/vladikk" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/vladikk" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/vladikkhononov" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/1736215/vladikk" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.instagram.com/vladikkk" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://telegram.me/vladik_kh" title="Telegram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-telegram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="vladikk.com">Vladik Khononov</a>
            
          

          &nbsp;&bull;&nbsp;
          2024

          
            &nbsp;&bull;&nbsp;
            <a href="https://vladikk.com">Vladikk</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.56.3</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://vladikk.com/js/main.js"></script>
<script src="https://vladikk.com/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="https://vladikk.com/js/load-photoswipe.js"></script>

 <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a2d0cd9bc54813f"></script>

  </body>
</html>

